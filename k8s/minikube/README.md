# Minikube - Quick Start

## 0) Configure secrets (local-only)

Create the secret manifests from templates, then fill real values:

```bash
cp k8s/minikube/postgres/secret.example.yaml k8s/minikube/postgres/secret.yaml
cp k8s/minikube/api/secret.example.yaml k8s/minikube/api/secret.yaml
cp k8s/minikube/frontend/secret.example.yaml k8s/minikube/frontend/secret.yaml
cp k8s/minikube/zitadel/secret.example.yaml k8s/minikube/zitadel/secret.yaml
```

These `secret.yaml` files are gitignored and must not be committed.

## 1) Deploy

```bash
cd infraBloc3
make minikube-deploy
```

## 2) Configure hosts

```bash
echo "$(minikube ip) collector.local zitadel.collector.local" | sudo tee -a /etc/hosts
```

## 3) Check status

```bash
make minikube-status
```

## Endpoints

- Frontend: `https://collector.local`
- API health: `https://collector.local/health`
- Zitadel: `https://zitadel.collector.local`

## Useful commands

```bash
make minikube-logs-api
make minikube-logs-frontend
make minikube-delete
```

## Notes

- TLS secret is generated by `k8s/minikube/scripts/generate-cert.sh`.
- Kubernetes manifests are centralized in `k8s/minikube/kustomization.yaml`.
- Prisma migration runs as a Kubernetes job during `make minikube-deploy` using the `collector-api-migrate:latest` image.
